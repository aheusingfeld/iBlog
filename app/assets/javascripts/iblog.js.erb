$(document).ready(function() {
  // fix 404 avatar images
  $("img.avatar").each(function() {
    if (
      (
        (typeof this.naturalWidth != "undefined" && this.naturalWidth == 0) ||
        this.readyState == 'uninitialized'
      ) && ($(this).attr("src") != "<%= image_path("avatar.png") %>")
    ) {
      $(this).attr("src", "<%= image_path("avatar.png") %>");
    }
  });

  moment.lang('de');
  $('.comment-timestamp time[datetime]').each(function (idx, item) {
      var time = moment($(item).attr('datetime')).local();
      $(item).attr("title", time.format("dddd, Do MMMM YYYY [um] HH:mm:ss")).text(time.fromNow());
  });
});
